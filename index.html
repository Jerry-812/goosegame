<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#ff4b9a" />
    <title>芭比消除</title>
    <meta name="description" content="芭比娃娃主题合并消除小游戏：点击可见娃娃进栏，三个相同自动消除，60 秒内通关。" />
    <meta property="og:title" content="芭比消除" />
    <meta property="og:description" content="点击可见娃娃进栏，三个相同自动消除，60 秒内通关。" />
    <meta property="og:image" content="./images/barbie_princess.png" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary" />
    <link rel="stylesheet" href="./styles.css" />
    <link rel="icon" href="./images/barbie_princess.png" />
    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="apple-touch-icon" href="./icons/icon-192.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  </head>
  <body>
    <main class="app">
      <header class="header">
        <div class="brand" aria-label="游戏标题">
          <img class="brand-logo" src="./images/barbie_princess.png" alt="" />
          <div class="brand-text">
            <div class="brand-title">芭比消除</div>
            <div class="brand-sub">三合消除 · 60 秒挑战</div>
          </div>
        </div>

        <div class="stats" aria-label="游戏信息">
          <div class="pill">
            <div class="pill-label">得分</div>
            <div class="pill-value" id="score">0</div>
          </div>
          <div class="pill" id="timerPill">
            <div class="pill-label">时间</div>
            <div class="pill-value"><span id="timer">60</span><span class="unit">s</span></div>
          </div>
          <div class="pill">
            <div class="pill-label">剩余</div>
            <div class="pill-value"><span id="remain">0</span></div>
          </div>
          <div class="pill">
            <div class="pill-label">最佳</div>
            <div class="pill-value" id="best">0</div>
          </div>
        </div>

        <div class="controls" aria-label="操作按钮">
          <button class="btn icon" id="soundBtn" type="button" aria-label="声音开关" title="声音">
            <span class="icon" aria-hidden="true">🔊</span>
          </button>
          <button class="btn" id="shareBtn" type="button">分享</button>
          <button class="btn" id="helpBtn" type="button" aria-label="玩法说明">玩法</button>
          <button class="btn primary" id="restartBtn" type="button">重开</button>
        </div>
      </header>

      <section class="board-wrap">
        <div class="board" id="board" aria-label="游戏区域" role="application">
          <img class="pot" src="./images/pot.png" alt="" />
          <div class="merge-fx" id="mergeFx" hidden></div>
          <canvas class="confetti" id="confetti" width="1" height="1" hidden></canvas>
        </div>
      </section>

      <footer class="tray" aria-label="待合成栏">
        <div class="tray-title">
          <div>待合成栏</div>
          <div class="tray-sub"><span id="trayCount">0</span>/<span id="trayMax">7</span></div>
        </div>
        <div class="tray-slots" id="traySlots"></div>
      </footer>

      <div class="overlay" id="overlay" hidden>
        <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="dialogTitle">
          <div class="dialog-title" id="dialogTitle"></div>
          <div class="dialog-sub" id="dialogSub"></div>
          <div class="dialog-actions">
            <button class="btn" id="shareEndBtn" type="button">分享链接</button>
            <button class="btn primary" id="againBtn" type="button">再来一局</button>
          </div>
        </div>
      </div>

      <div class="overlay" id="help" hidden>
        <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
          <div class="dialog-title" id="helpTitle">玩法</div>
          <div class="dialog-sub">
            <div class="mode">
              <div class="mode-title">难度</div>
              <div class="mode-options" role="radiogroup" aria-label="难度选择">
                <label class="mode-opt">
                  <input type="radio" name="mode" value="easy" checked />
                  <span>轻松</span>
                </label>
                <label class="mode-opt">
                  <input type="radio" name="mode" value="normal" />
                  <span>标准</span>
                </label>
                <label class="mode-opt">
                  <input type="radio" name="mode" value="hard" />
                  <span>高手</span>
                </label>
              </div>
              <div class="mode-sub" id="modeDesc">30 个娃娃 · 60 秒 · 7 格待合成栏</div>
            </div>
            <ul class="help-list">
              <li>只能点击“最上层可见”的娃娃（被遮挡的会半透明且不可点）。</li>
              <li>点击后进入底部待合成栏；同类型累计 3 个会自动消除并加分。</li>
              <li>60 秒内清空所有娃娃获胜；待合成栏放满且无法继续放置则失败。</li>
            </ul>
          </div>
          <div class="dialog-actions">
            <button class="btn" id="copySeedBtn" type="button">复制局号</button>
            <button class="btn primary" id="closeHelpBtn" type="button">开始</button>
          </div>
        </div>
      </div>

      <div class="toast" id="toast" role="status" aria-live="polite" hidden></div>

      <div class="overlay" id="loading" hidden>
        <div class="dialog loading">
          <div class="dialog-title">加载中…</div>
          <div class="dialog-sub" id="loadingText">正在准备素材</div>
          <div class="loading-bar"><div class="loading-fill" id="loadingFill"></div></div>
        </div>
      </div>
    </main>

    <script src="./main.js" type="module"></script>
  </body>
</html>
